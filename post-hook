#!/bin/sh
# Post-{commit,checkout,merge} hook for generation git information
#
git log -1 HEAD --date=iso --pretty=format:"
%% This is file is generated after git commit, checkout or merge.
%% Do not edit it!
\newcommand{\GitAbbrHash}{%h}
\newcommand{\GitDate}{%ad}
" > gitinfo.tex

git log -1 HEAD --date=iso --pretty=format:"%s" |
  sed 's/\\/\\textbackslashXXX/g' |
  sed 's/~/\\textasciitildeXXX/g' |
  sed 's/\^/\\textasciicircumXXX/g' |
  sed 's/\([&$#_%{}]\)/\\\1/g' |
  sed 's/\(textbackslash\|textasciitilde\|textasciicircum\)XXX/\1{}/g' |
  sed 's/\(.*\)/\\newcommand{\\GitSubject}{\1}/g' >> gitinfo.tex

